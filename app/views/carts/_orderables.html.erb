<!-- Carrinho do Cliente -->
<div class="card card-primary">
  <div class="card-header">
    <div class="float-left">
      <h5 class="mb-0">Cliente: <%= @client.name %></h5>
      <p class="mb-0">Data: <%= @cart.date.strftime("%d/%m/%Y") %></p>
    </div>
  </div>
  <div class="card-body">
    <table class="table table-bordered table-hover">
      <thead>
        <tr>
          <th>Nome do Produto</th>
          <th>Preço Unitário</th>
          <th>Editar</th>
          <th>Total Parcial</th>
        </tr>
      </thead>
      <tbody>
        <% @orderables.each do |orderable| %>
          <% if orderable.cart_id === @cart.id %>
            <tr>
              <td><%= orderable.product.name %></td>
              <td><%= number_to_currency(orderable.product.sale_price, unit: 'R$', separator: ',', delimiter: '.') %></td>
              <td>
                <div class="form-inline">
                  <%= form_with(url: update_orderable_item_path) do |f| %>
                    <%= f.hidden_field :client_id, value: @client.id %>
                    <%= f.hidden_field :orderable_id, value: orderable.id %>
                    <%= f.number_field :quantity, step: 0.01, value: orderable.quantity, class: "form-control" %>
                    <%= f.submit "Atualizar", class: "btn btn-success btn-sm mr-1" %>
                  <% end %>
                  <%= form_with(url: remove_orderable_item_path) do |f| %>
                    <%= f.hidden_field :client_id, value: @client.id %>
                    <%= f.hidden_field :orderable_id, value: orderable.id %>
                    <%= f.submit "Remover", class: "btn btn-danger btn-sm" %>
                  <% end %>
                </div>
              </td>
              <td><%= number_to_currency(orderable.total, unit: 'R$', separator: ',', delimiter: '.') %></td> 
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>

    <div class="mt-3"> <!-- Espaçamento vertical -->
      <div class="form-inline">
        <%= form_with(url: orderable_discount_or_addition_path) do |f| %>
          <%= f.hidden_field :client_id, value:@client.id  %>
          <%= f.hidden_field :cart_id , value:@cart.id%>
          <%= f.number_field :quantity, step: 0.01, class: "form-control mr-1", placeholder: "Quantidade (R$)" %>
          <%= f.submit "Aplicar Desconto", name: "discount", class: "btn btn-primary btn-sm mr-1" %>
          <%= f.submit "Aplicar Acréscimo", name: "addition", class: "btn btn-warning btn-sm"  %>
        <% end %>
      </div>
    </div>

    <% if @cart.discount.present? %>
      <%= "Desconto#{@cart.discount} " %>
      <div class="card-footer mt-3">
        <strong>TOTAL:</strong> <%= number_to_currency(@cart.total - @cart.discount, unit: 'R$', separator: ',', delimiter: '.') %>
        <%= link_to sell_cart_path(cart_balance:@cart.total - @cart.discount), class: "btn btn-success btn-sm" do %>
          <i class="fas fa-cart-plus ml-1"></i> A VISTA 
        <% end %>
      </div>
    <%elsif @cart.addition.present? %>
      <%= "Acrescimo#{@cart.addition}" %>
      <div class="card-footer mt-3">
        <strong>TOTAL:</strong> <%= number_to_currency(@cart.total + @cart.addition, unit: 'R$', separator: ',', delimiter: '.') %>
        <%= link_to sell_cart_path(cart_balance:@cart.total + @cart.addition), class: "btn btn-success btn-sm" do %>
          <i class="fas fa-cart-plus ml-1"></i> A VISTA 
        <% end %>
      </div>
    <% else %>
      <div class="card-footer mt-3">
        <div style="display: flex; justify-content:space-between;">
          <div class="mt-2">
            <strong>TOTAL:</strong> <%= number_to_currency(@cart.total, unit: 'R$', separator: ',', delimiter: '.') %>
          
            
            <%= link_to "A vista", sell_cart_path(cart_balance:@cart.total), class:"btn btn-success btn-sm mr-1"%>
          </div>
          
          <div class="mt-1">
            <div class="form-inline">
              <%= form_with url: foward_sell_cart_path, method: :post, data: { turbo: false } do |f|%>
                <%= f.hidden_field :cart_balance, value:@cart.total  %>
                <%= f.number_field :quantity, step: 0.01, class: "form-control mr-1", placeholder: "Valor de Entrada (R$)" %>
                <%= f.submit "A Prazo", class: "btn btn-primary btn-sm" %>
              <% end %>
            </div>
          </div>
          
        </div>

      </div>
    <% end %>

    
    
  </div>
</div>


<div class="card card-primary card-tabs">
  <div class="card-header p-0 pt-1">
    <ul class="nav nav-tabs" id="custom-tabs-one-tab" role="tablist">

      <li class="nav-item">
        <a class="nav-link active" id="custom-tabs-one-home-tab" data-bs-toggle="pill" href="#custom-tabs-one-home" role="tab" aria-controls="custom-tabs-one-home" aria-selected="true">RIPA</a>
      </li>

      <li class="nav-item">
        <a class="nav-link" id="custom-tabs-one-profile-tab" data-bs-toggle="pill" href="#custom-tabs-one-profile" role="tab" aria-controls="custom-tabs-one-profile" aria-selected="false">CAIBRO</a>
      </li>

      <li class="nav-item">
        <a class="nav-link" id="custom-tabs-one-messages-tab" data-bs-toggle="pill" href="#custom-tabs-one-messages" role="tab" aria-controls="custom-tabs-one-messages" aria-selected="false">FRECHAL</a>
      </li>
      
      <li class="nav-item">
        <a class="nav-link" id="custom-tabs-one-settings-tab" data-bs-toggle="pill" href="#custom-tabs-one-settings" role="tab" aria-controls="custom-tabs-one-settings" aria-selected="false">VIGA</a>
      </li>

      <li class="nav-item">
        <a class="nav-link" id="custom-tabs-one-products-tab" data-bs-toggle="pill" href="#custom-tabs-one-products" role="tab" aria-controls="custom-tabs-one-products" aria-selected="false">Todos os Produtos</a>
      </li>
    </ul>
  </div>

  <div class="card-body">
    <div class="tab-content" id="custom-tabs-one-tabContent">

      <div class="tab-pane fade show active" id="custom-tabs-one-home" role="tabpanel" aria-labelledby="custom-tabs-one-home-tab">
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Unidade</th>
              <th>Preço</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <% @products.each do |product| %>
              <% if product.name.start_with?("RIPA") %>
                <tr>
                  <td><%= product.name %></td>
                  <td><%= product.unity %></td>
                  <td><%= product.sale_price %></td>
                  <td>
                    <div class="d-flex">
                      <%= form_with(url: cart_orderable_path) do |form| %>
                        <%= form.hidden_field :client_id, value: @client.id %>
                        <%= form.hidden_field :product_id, value: product.id %>
                        <div class="d-flex align-items-center">
                          <%= form.number_field :quantity, step: 0.01, placeholder: 'Quantidade', class:"form-control mr-1" %>
                          <%= button_tag(type: 'submit', class: 'btn btn-primary btn-sm') do %>
                            <i class="fas fa-cart-plus mr-1"></i> Incluir no Carrinho de Venda
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>

      <div class="tab-pane fade" id="custom-tabs-one-profile" role="tabpanel" aria-labelledby="custom-tabs-one-profile-tab">
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Unidade</th>
              <th>Preço</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <% @products.each do |product| %>
              <% if product.name.start_with?("CAIBRO") %>
                <tr>
                  <td><%= product.name %></td>
                  <td><%= product.unity %></td>
                  <td><%= product.sale_price %></td>
                  <td>
                    <div class="d-flex">
                      <%= form_with(url: cart_orderable_path) do |form| %>
                        <%= form.hidden_field :client_id, value: @client.id %>
                        <%= form.hidden_field :product_id, value: product.id %>
                        <div class="d-flex align-items-center">
                          <%= form.number_field :quantity, step: 0.01, placeholder: 'Quantidade', class:"form-control mr-1" %>
                          <%= button_tag(type: 'submit', class: 'btn btn-primary btn-sm') do %>
                            <i class="fas fa-cart-plus mr-1"></i> Incluir no Carrinho de Venda
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>

      <div class="tab-pane fade" id="custom-tabs-one-messages" role="tabpanel" aria-labelledby="custom-tabs-one-messages-tab">
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Unidade</th>
              <th>Preço</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <% @products.each do |product| %>
              <% if product.name.start_with?("FRECHAL") %>
                <tr>
                  <td><%= product.name %></td>
                  <td><%= product.unity %></td>
                  <td><%= product.sale_price %></td>
                  <td>
                    <div class="d-flex">
                      <%= form_with(url: cart_orderable_path) do |form| %>
                        <%= form.hidden_field :client_id, value: @client.id %>
                        <%= form.hidden_field :product_id, value: product.id %>
                        <div class="d-flex align-items-center">
                          <%= form.number_field :quantity, step: 0.01, placeholder: 'Quantidade', class:"form-control mr-1" %>
                          <%= button_tag(type: 'submit', class: 'btn btn-primary btn-sm') do %>
                            <i class="fas fa-cart-plus mr-1"></i> Incluir no Carrinho de Venda
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>

      <div class="tab-pane fade" id="custom-tabs-one-settings" role="tabpanel" aria-labelledby="custom-tabs-one-settings-tab">
        <table class="table table-bordered table-hover">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Unidade</th>
              <th>Preço</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <% @products.each do |product| %>
              <% if product.name.start_with?("VIGA") %>
                <tr>
                  <td><%= product.name %></td>
                  <td><%= product.unity %></td>
                  <td><%= product.sale_price %></td>
                  <td>
                    <div class="d-flex">
                      <%= form_with(url: cart_orderable_path) do |form| %>
                        <%= form.hidden_field :client_id, value: @client.id %>
                        <%= form.hidden_field :product_id, value: product.id %>
                        <div class="d-flex align-items-center">
                          <%= form.number_field :quantity, step: 0.01, placeholder: 'Quantidade', class:"form-control mr-1" %>
                          <%= button_tag(type: 'submit', class: 'btn btn-primary btn-sm') do %>
                            <i class="fas fa-cart-plus mr-1"></i> Incluir no Carrinho de Venda
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>

      <div class="tab-pane fade" id="custom-tabs-one-products" role="tabpanel" aria-labelledby="custom-tabs-one-products-tab">
        <%= form_with url: search_product_path, method: :get, class: "form-inline justify-content-center" do |form| %>
          <div class="input-group" style="width: 500px;">
            <%= form.text_field :product_name, placeholder: "Em desenvolvimento...", class: "form-control", disabled: true %>
            <%= button_tag(type: 'submit', class: 'btn btn-outline-info btn-sm', disabled: true) do %>
              <i class="fa fa-search mr-1"></i>
            <% end %>
          </div>
        <% end %>

        <table class="table table-bordered table-hover mt-3">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Unidade</th>
              <th>Preço</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody>
            <% if @products_name.present? %>
              <% @products_name.each do |product| %>
                <tr>
                  <td><%= product.name %></td>
                  <td><%= product.unity %></td>
                  <td><%= product.sale_price %></td>
                  <td>
                    <div class="d-flex">
                      <%= form_with(url: cart_orderable_path) do |form| %>
                        <%= form.hidden_field :client_id, value: @client.id %>
                        <%= form.hidden_field :product_id, value: product.id %>
                        <div class="d-flex align-items-center">
                          <%= form.number_field :quantity, step: 0.01, placeholder: 'Quantidade', class:"form-control mr-1" %>
                          <%= button_tag(type: 'submit', class: 'btn btn-primary btn-sm') do %>
                            <i class="fas fa-cart-plus mr-1"></i> Incluir no Carrinho de Venda
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% else %>
              <% @products.each do |product| %>
                <tr>
                  <td><%= product.name %></td>
                  <td><%= product.unity %></td>
                  <td><%= product.sale_price %></td>
                  <td>
                    <div class="d-flex">
                      <%= form_with(url: cart_orderable_path) do |form| %>
                        <%= form.hidden_field :client_id, value: @client.id %>
                        <%= form.hidden_field :product_id, value: product.id %>
                        <div class="d-flex align-items-center">
                          <%= form.number_field :quantity, step: 0.01, placeholder: 'Quantidade', class:"form-control mr-1" %>
                          <%= button_tag(type: 'submit', class: 'btn btn-primary btn-sm') do %>
                            <i class="fas fa-cart-plus mr-1"></i> Incluir no Carrinho de Venda
                          <% end %>
                        </div>
                      <% end %>
                    </div>
                  </td>
                </tr>
              <% end %>
            <% end %>
          </tbody>
        </table>
      </div>

    </div>
  </div>
</div>



